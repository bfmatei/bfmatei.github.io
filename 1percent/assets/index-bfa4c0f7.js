import{G as R,j as t,I as x,C as Se,a as Re,H as Pe,b as Me,B as F,V as Ce,F as ie,c as se,d as Ie,e as Fe,f as Ee,g as le,R as De,S as ke,h as Ne,u as Le,i as Oe,k as z,l as Te,m as L,n as O,T as We,o as ze,p as Ve,q as Be,r as $,s as j,t as Ae,v as w,A as _e,M as qe,w as He,x as $e,y as Ue,z as Ge,D as Je}from"./ui-df5eefb4.js";import{a as Ye,r as P}from"./react-25ef465b.js";import{u as Ke,c as Xe,d as oe,e as D,f as Ze,g as Qe,P as et}from"./state-c8ebdb8d.js";import{u as ce}from"./forms-14bab017.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();var ue,U=Ye;ue=U.createRoot,U.hydrateRoot;function V(e){return R({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M12 192h424c6.6 0 12 5.4 12 12v260c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V204c0-6.6 5.4-12 12-12zm436-44v-36c0-26.5-21.5-48-48-48h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v36c0 6.6 5.4 12 12 12h424c6.6 0 12-5.4 12-12z"}}]})(e)}function tt(e){return R({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"}}]})(e)}function de(e){return R({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 176c-44.19 0-80-42.99-80-96 0-53.02 35.82-96 80-96s80 42.98 80 96c0 53.03-35.83 96-80 96zm272 48h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"}}]})(e)}function nt(e){return R({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"}}]})(e)}function at(e){return R({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M109.25 173.25c24.99-24.99 24.99-65.52 0-90.51-24.99-24.99-65.52-24.99-90.51 0-24.99 24.99-24.99 65.52 0 90.51 25 25 65.52 25 90.51 0zm256 165.49c-24.99-24.99-65.52-24.99-90.51 0-24.99 24.99-24.99 65.52 0 90.51 24.99 24.99 65.52 24.99 90.51 0 25-24.99 25-65.51 0-90.51zm-1.94-231.43l-22.62-22.62c-12.5-12.5-32.76-12.5-45.25 0L20.69 359.44c-12.5 12.5-12.5 32.76 0 45.25l22.62 22.62c12.5 12.5 32.76 12.5 45.25 0l274.75-274.75c12.5-12.49 12.5-32.75 0-45.25z"}}]})(e)}function rt(e){return R({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"}}]})(e)}var b=(e=>(e[e.Regular=0]="Regular",e[e.ReduceInstallment=1]="ReduceInstallment",e[e.ReducePeriod=2]="ReducePeriod",e))(b||{});function it(e){return Array.from(Array(e))}function G(e){return e<10?`0${e}`:e.toString()}function E(e,a,n){return`${e}-${G(a)}-${G(n)}`}function C(e){const[a,n,s]=e.split("-");return[Number(a),Number(n),Number(s)]}function st(e,a,n=!0){const s=new Date(e),i=new Date(a);return(i.getFullYear()-s.getFullYear())*12-s.getMonth()+i.getMonth()+Number(n)}function T(e,a,n=!0){const s=new Date(e),i=new Date(a);return Math.floor((i.getTime()-s.getTime())/864e5)+Number(n)}function fe(e,a){const n=new Date(e);return n.setMonth(n.getMonth()+a),E(n.getFullYear(),n.getMonth()+1,n.getDate())}function lt(){const e=new Date;return E(e.getFullYear(),e.getMonth()+1,e.getDate())}function ot(e){return e/1200}function he(e,a){return Math.pow(e+1,a)}function ct(e,a,n){const s=he(e,a);return n*e/(1-1/s)}function ut(e,a,n,s){const i=he(e,a);return n*i-s*(i-1)/e}function dt(e,a,n,s){return n===1?a*e:ut(e,n-1,a,s)*e}function ft(e,a){return e-a}const J="abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ0123456789";function me(e=10){return it(e).map(()=>J[Math.floor(Math.random()*J.length)]).join("")}function I(e){return Number(e.toFixed(2).replace(/^-0$/,"0"))}const ht=({onEarlyPaymentAdd:e})=>{const a=o=>e({...o,summable:o.summable==="true",type:Number(o.type)}),{handleChange:n,handleSubmit:s,errors:i,values:r}=ce({initialValues:{type:b.ReduceInstallment.toString(),date:lt(),value:1e3,summable:"true"},onSubmit:a,validateOnMount:!0});return t.jsxs(ye,{submitLabel:"Add",title:"Add Early Payment",onSubmit:s,children:[t.jsx(Y,{error:i.type,id:"type",options:[{label:"Installment",value:b.ReduceInstallment.toString()},{label:"Period",value:b.ReducePeriod.toString()}],label:"Reduce",value:r.type,onValueChange:n}),t.jsx(S,{error:i.value,icon:t.jsx(x,{as:de}),id:"value",label:"Value",type:"number",value:r.value,onValueChange:n}),t.jsx(S,{error:i.date,icon:t.jsx(x,{as:V}),id:"date",label:"Date",type:"date",value:r.date,onValueChange:n}),t.jsx(Y,{error:i.summable,id:"summable",options:[{label:"Yes",value:"true"},{label:"No",value:"false"}],label:"Summable",value:r.summable,onValueChange:n})]})},ge=({children:e,title:a})=>t.jsxs(Se,{children:[t.jsx(Re,{children:t.jsx(Pe,{size:"md",children:a})}),t.jsx(Me,{children:e})]}),mt=({label:e})=>t.jsx(F,{type:"submit",colorScheme:"green",width:"full",children:e}),ye=({children:e,onSubmit:a,submitLabel:n,title:s})=>t.jsx(ge,{title:s,children:t.jsx("form",{onSubmit:a,children:t.jsxs(Ce,{spacing:"4",align:"flex-start",children:[e,t.jsx(mt,{label:n})]})})}),S=({error:e,icon:a,id:n,label:s,onValueChange:i,type:r,value:o})=>t.jsxs(ie,{isInvalid:!!e,children:[t.jsx(se,{htmlFor:n,children:s}),t.jsxs(Ie,{children:[t.jsx(Fe,{pointerEvents:"none",fontSize:"1.2em",children:a}),t.jsx(Ee,{id:n,name:n,type:r,variant:"filled",required:!0,value:o,onChange:i})]}),t.jsx(le,{children:e})]}),Y=({error:e,id:a,label:n,onValueChange:s,options:i,value:r})=>t.jsxs(ie,{isInvalid:!!e,children:[t.jsx(se,{htmlFor:a,children:n}),t.jsx(De,{id:a,name:a,value:r,children:t.jsx(ke,{direction:"row",children:i.map(({label:o,value:c})=>t.jsx(Ne,{value:c,onChange:s,children:o},c))})}),t.jsx(le,{children:e})]}),gt=()=>{const{colorMode:e,toggleColorMode:a}=Le();return t.jsxs(t.Fragment,{children:[t.jsx(Oe,{textColor:z("whiteAlpha.900","whiteAlpha.900"),fontWeight:"bold",children:"1Percent"}),t.jsx(F,{onClick:a,"aria-label":"Change theme",children:e==="light"?t.jsx(x,{as:nt}):t.jsx(x,{as:rt})})]})},yt=({header:e,main:a,sidebar:n})=>t.jsxs(Te,{background:z("gray.100","gray.800"),gap:"4",gridTemplateColumns:L({base:"100%",md:"0 300px 1fr 0"},{fallback:"md"}),gridTemplateRows:L({base:"64px auto auto",md:"64px 1fr 0"},{fallback:"md"}),minHeight:"100vh",templateAreas:L({base:'"header" "sidebar" "main"',md:'"header header header header" "buffer1 sidebar main buffer2" "footer footer footer footer"'},{fallback:"md"}),children:[t.jsx(O,{alignItems:"center",area:"header",background:z("green.600","gray.900"),display:"flex",justifyContent:"space-between",paddingInline:"4",children:e}),t.jsx(O,{area:"sidebar",display:"grid",gap:"4",height:"fit-content",children:n}),t.jsx(O,{area:"main",overflow:"auto",children:a})]}),pt=({items:e})=>t.jsx(ge,{title:"Repayment Schedule",children:t.jsx(We,{children:t.jsxs(ze,{variant:"striped",colorScheme:"green",children:[e.length===0?t.jsx(Ve,{children:"Click 'Change' in the settings panel"}):null,t.jsx(Be,{children:t.jsxs($,{children:[t.jsx(j,{children:"#"}),t.jsx(j,{children:"Early"}),t.jsx(j,{children:"Date"}),t.jsx(j,{isNumeric:!0,children:"Principal"}),t.jsx(j,{isNumeric:!0,children:"Interest"}),t.jsx(j,{isNumeric:!0,children:"Total"}),t.jsx(j,{isNumeric:!0,children:"Balance"})]})}),t.jsx(Ae,{children:e.map((a,n)=>t.jsxs($,{children:[t.jsx(w,{children:n+1}),t.jsx(w,{children:a.repaymentType!==b.Regular?t.jsx(x,{as:tt}):null}),t.jsx(w,{children:a.date}),t.jsxs(w,{isNumeric:!0,children:[I(a.principal)," RON"]}),t.jsxs(w,{isNumeric:!0,children:[I(a.interest)," RON"]}),t.jsxs(w,{isNumeric:!0,children:[I(a.total)," RON"]}),t.jsxs(w,{isNumeric:!0,children:[I(a.balance)," RON"]})]},a.id))})]})})}),xt=({initialValues:e,onSettingsChange:a})=>{const n=f=>{const g={};return f.balance<=0&&(g.balance="Balance must be greater than 0"),f.interestRate<=0&&(g.interestRate="Interest rate must be greater than 0"),Date.parse(f.firstPayment)>=Date.parse(f.finalMaturity)&&(g.firstPayment="First payment must be before final maturity",g.finalMaturity="Final maturity must be after first payment"),g},{errors:s,handleChange:i,handleSubmit:r,setFieldTouched:o,setFieldValue:c,values:u}=ce({initialValues:e,onSubmit:a,validate:n,validateOnMount:!0}),l=f=>{i(f);const[,,g]=C(f.target.value),h=C(u.finalMaturity);h[2]=g,c("finalMaturity",E(...h)),o("finalMaturity")},d=f=>{i(f);const[,,g]=C(f.target.value),h=C(u.firstPayment);h[2]=g,c("firstPayment",E(...h)),o("finalMaturity")};return t.jsxs(ye,{submitLabel:"Change",title:"Settings",onSubmit:r,children:[t.jsx(S,{error:s.balance,icon:t.jsx(x,{as:de}),id:"balance",onValueChange:i,label:"Balance",type:"number",value:u.balance}),t.jsx(S,{error:s.interestRate,icon:t.jsx(x,{as:at}),id:"interestRate",onValueChange:i,label:"Interest Rate",type:"number",value:u.interestRate}),t.jsx(S,{error:s.firstPayment,icon:t.jsx(x,{as:V}),id:"firstPayment",onValueChange:l,label:"First Payment",type:"date",value:u.firstPayment}),t.jsx(S,{error:s.finalMaturity,icon:t.jsx(x,{as:V}),id:"finalMaturity",onValueChange:d,label:"Final Maturity",type:"date",value:u.finalMaturity})]})},bt="modulepreload",vt=function(e){return"/1percent/"+e},K={},jt=function(a,n,s){if(!n||n.length===0)return a();const i=document.getElementsByTagName("link");return Promise.all(n.map(r=>{if(r=vt(r),r in K)return;K[r]=!0;const o=r.endsWith(".css"),c=o?'[rel="stylesheet"]':"";if(!!s)for(let d=i.length-1;d>=0;d--){const f=i[d];if(f.href===r&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${c}`))return;const l=document.createElement("link");if(l.rel=o?"stylesheet":bt,o||(l.as="script",l.crossOrigin=""),l.href=r,document.head.appendChild(l),o)return new Promise((d,f)=>{l.addEventListener("load",d),l.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>a())};function wt(e={}){const{immediate:a=!1,onNeedRefresh:n,onOfflineReady:s,onRegistered:i,onRegisteredSW:r,onRegisterError:o}=e;let c,u,l;const d=async(g=!0)=>{await u,await(l==null?void 0:l())};async function f(){if("serviceWorker"in navigator){const{Workbox:g}=await jt(()=>import("./workbox-window.prod.es5-dc90f814.js"),[]);c=new g("/1percent/promptServiceWorker.js",{scope:"/1percent/",type:"classic"}),l=async()=>{await(c==null?void 0:c.messageSkipWaiting())};{let h=!1;const y=()=>{h=!0,c==null||c.addEventListener("controlling",p=>{p.isUpdate&&window.location.reload()}),n==null||n()};c.addEventListener("installed",p=>{typeof p.isUpdate>"u"?typeof p.isExternal<"u"?p.isExternal?y():!h&&(s==null||s()):p.isExternal?window.location.reload():!h&&(s==null||s()):p.isUpdate||s==null||s()}),c.addEventListener("waiting",y),c.addEventListener("externalwaiting",y)}c.register({immediate:a}).then(h=>{r?r("/1percent/promptServiceWorker.js",h):i==null||i(h)}).catch(h=>{o==null||o(h)})}}return u=f(),d}function St(e={}){const{immediate:a=!0,onNeedRefresh:n,onOfflineReady:s,onRegistered:i,onRegisteredSW:r,onRegisterError:o}=e,[c,u]=P.useState(!1),[l,d]=P.useState(!1),[f]=P.useState(()=>wt({immediate:a,onOfflineReady(){d(!0),s==null||s()},onNeedRefresh(){u(!0),n==null||n()},onRegistered:i,onRegisteredSW:r,onRegisterError:o}));return{needRefresh:[c,u],offlineReady:[l,d],updateServiceWorker:f}}const Rt=()=>{const e=P.useRef(null),{needRefresh:[a,n],offlineReady:[,s],updateServiceWorker:i}=St({onRegisteredSW(c,u){u==null||u.update()},onRegisterError(c){console.log(c)}}),r=()=>{i(!0)},o=()=>{s(!1),n(!1)};return t.jsx(_e,{leastDestructiveRef:e,isOpen:a,onClose:o,closeOnOverlayClick:!1,children:t.jsx(qe,{children:t.jsxs(He,{children:[t.jsx($e,{fontSize:"lg",fontWeight:"bold",children:"Update available"}),t.jsx(Ue,{children:"Click reload to update the app"}),t.jsxs(Ge,{children:[t.jsx(F,{ref:e,onClick:o,children:"Close"}),t.jsx(F,{colorScheme:"green",onClick:r,ml:3,children:"Reload"})]})]})})})},Pt=Ke,X=Xe,Mt=localStorage.getItem("items")?JSON.parse(localStorage.getItem("items")):{data:[]},Z=e=>{var l;const{balance:a,finalMaturity:n,firstPayment:s,interestRate:i}=e,r=ot(i),o=st(s,n),c=[],u=ct(r,o,a);for(let d=0;d<o;d++){const f=fe(s,d),g=dt(r,a,d+1,u),h=ft(u,g),y=(((l=c[d-1])==null?void 0:l.balance)??a)-h;c.push({id:me(),repaymentType:b.Regular,date:f,principal:h,interest:g,total:u,balance:y,original:{principal:h,interest:g,total:u,balance:y},saved:0})}return c},pe=oe({name:"items",initialState:Mt,reducers:{addEarlyPayment:(e,a)=>{const{date:n,value:s,type:i,summable:r}=a.payload,o=new Date(n),{lastPayment:c,lastWholePayment:u,nextWholePayment:l,nextWholePaymentIndex:d,savedTotal:f}=e.data.reduce((m,v,M)=>{const we=new Date(v.date)<o,H=v.repaymentType===b.Regular;return we?(m.savedTotal+=v.saved,m.lastPayment=v,m.lastPaymentIndex=M,H&&(m.lastWholePayment=v,m.lastWholePaymentIndex=M)):(m.nextPayment=m.nextPayment??v,m.nextPaymentIndex=m.nextPaymentIndex??M,H&&(m.nextWholePayment=m.nextWholePayment??v,m.nextWholePaymentIndex=m.nextWholePaymentIndex??M)),m},{savedTotal:0}),g=Math.min(c.balance,s+f),h=c.balance-g,y=e.data[e.data.length-1],p=i===b.ReduceInstallment?y.date:fe(y.date,-1*Math.floor(g/l.original.principal)),ve=T(u.date,l.date,!0),je=T(c.date,n,!0),k=l.original.interest/30*(je-(ve-30)),A=g+k;let N=[],_=0;if(h>0){N=Z({balance:h,firstPayment:l.date,finalMaturity:p,interestRate:5.8});const m=N[0];m.interest=m.original.interest/30*T(n,m.date,!0),m.total=m.original.total-(m.original.interest-m.interest),r&&(_=l.original.total-m.original.total)}const q=[...e.data];q.splice(d),e.data=[...q,{id:me(),repaymentType:i,date:n,principal:g,interest:k,total:A,balance:h,original:{principal:g,interest:k,total:A,balance:h},saved:_},...N],localStorage.setItem("items",JSON.stringify(e))},generateItems:(e,a)=>{e.data=Z(a.payload),localStorage.setItem("items",JSON.stringify(e))}}}),{addEarlyPayment:Ct,generateItems:It}=pe.actions,Ft=e=>e.items.data,Et=localStorage.getItem("settings")?JSON.parse(localStorage.getItem("settings")):{balance:588e3,finalMaturity:"2035-12-20",firstPayment:"2021-01-20",interestRate:5.8},xe=oe({name:"settings",initialState:Et,reducers:{setSettings:(e,a)=>{e.balance=a.payload.balance,e.finalMaturity=a.payload.finalMaturity,e.firstPayment=a.payload.firstPayment,e.interestRate=a.payload.interestRate,localStorage.setItem("settings",JSON.stringify(e))}}}),{setSettings:Dt}=xe.actions,kt=e=>e.settings;globalThis&&globalThis.__generator;globalThis&&globalThis.__spreadArray;var B;(function(e){e.uninitialized="uninitialized",e.pending="pending",e.fulfilled="fulfilled",e.rejected="rejected"})(B||(B={}));var Q=D("__rtkq/focused"),ee=D("__rtkq/unfocused"),te=D("__rtkq/online"),ne=D("__rtkq/offline"),W=!1;function Nt(e,a){function n(){var s=function(){return e(Q())},i=function(){return e(ee())},r=function(){return e(te())},o=function(){return e(ne())},c=function(){window.document.visibilityState==="visible"?s():i()};W||typeof window<"u"&&window.addEventListener&&(window.addEventListener("visibilitychange",c,!1),window.addEventListener("focus",s,!1),window.addEventListener("online",r,!1),window.addEventListener("offline",o,!1),W=!0);var u=function(){window.removeEventListener("focus",s),window.removeEventListener("visibilitychange",c),window.removeEventListener("online",r),window.removeEventListener("offline",o),W=!1};return u}return a?a(e,{onFocus:Q,onFocusLost:ee,onOffline:ne,onOnline:te}):n()}var ae;(function(e){e.query="query",e.mutation="mutation"})(ae||(ae={}));B.uninitialized;var re;typeof queueMicrotask=="function"&&queueMicrotask.bind(typeof window<"u"?window:typeof global<"u"?global:globalThis);const be=Ze({reducer:Qe({items:pe.reducer,settings:xe.reducer})});Nt(be.dispatch);const Lt=()=>{const e=Pt(),a=X(kt),n=X(Ft),s=r=>{e(Ct(r))},i=r=>{e(Dt(r)),e(It(r))};return t.jsxs(t.Fragment,{children:[t.jsx(Rt,{}),t.jsx(yt,{header:t.jsx(gt,{}),main:t.jsx(pt,{items:n}),sidebar:t.jsxs(t.Fragment,{children:[t.jsx(xt,{initialValues:a,onSettingsChange:i}),n.length>0?t.jsx(ht,{onEarlyPaymentAdd:s}):null]})})]})},Ot=document.getElementById("root");ue(Ot).render(t.jsx(P.StrictMode,{children:t.jsx(et,{store:be,children:t.jsx(Je,{children:t.jsx(Lt,{})})})}));
