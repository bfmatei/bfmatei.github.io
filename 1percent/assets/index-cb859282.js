import{j as n,F as q,u as j,a as ye,B as R,b as T,c as ne,M as pe,S as ge,T as xe,d as be,e as ve,f as je,g as z,h as x,i as we,k as b,V as Pe,l as M,m as I,I as F,n as E,o as S,p as C,C as $,q as Me}from"./ui-cf6caefd.js";import{a as Ie,r as ae}from"./react-25ef465b.js";import{u as Fe,a as Ee,c as re,b as k,d as Se,e as Ce,P as De}from"./state-dc21e7a1.js";import{u as Te}from"./forms-ba993d7c.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function a(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=a(r);fetch(r.href,i)}})();var ie,G=Ie;ie=G.createRoot,G.hydrateRoot;const ke=({children:e})=>n.jsx(q,{direction:j({base:"column",md:"row"},{fallback:"md"}),flex:"1",padding:j({base:"0",md:"8"},{fallback:"md"}),width:"100vw",children:e}),Le=()=>{const{colorMode:e,toggleColorMode:t}=ye();return n.jsx(R,{background:T("green.600","gray.900"),paddingInline:"4",width:"100%",children:n.jsxs(q,{height:"16",alignItems:"center",justifyContent:"space-between",children:[n.jsx(R,{textColor:T("whiteAlpha.900","whiteAlpha.900"),fontWeight:"bold",children:"1Percent"}),n.jsx(ne,{onClick:t,"aria-label":"Change theme",children:e==="light"?n.jsx(pe,{}):n.jsx(ge,{})})]})})},Ne=Fe,Y=Ee,se=()=>T("white","gray.900");function Re(e){return Array.from(Array(e))}function O(e,t,a){const s=t<10?`0${t}`:t,r=a<10?`0${a}`:a;return`${e}-${s}-${r}`}function D(e){const[t,a,s]=e.split("-");return[Number(t),Number(a),Number(s)]}function Oe(e,t,a=!0){const s=new Date(e),r=new Date(t);return(r.getFullYear()-s.getFullYear())*12-s.getMonth()+r.getMonth()+Number(a)}function H(e,t,a=!0){const s=new Date(e),r=new Date(t);return Math.floor((r.getTime()-s.getTime())/864e5)+Number(a)}function le(e,t){const a=new Date(e);return a.setMonth(a.getMonth()+t),O(a.getFullYear(),a.getMonth()+1,a.getDate())}function We(e){return e/1200}function oe(e,t){return Math.pow(e+1,t)}function qe(e,t,a){const s=oe(e,t);return a*e/(1-1/s)}function Be(e,t,a,s){const r=oe(e,t);return a*r-s*(r-1)/e}function Ae(e,t,a,s){return a===1?t*e:Be(e,a-1,t,s)*e}function _e(e,t){return e-t}const K="abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ0123456789";function ce(e=10){return Re(e).map(()=>K[Math.floor(Math.random()*K.length)]).join("")}function v(e){return Number(e.toFixed(2).replace(/^-0$/,"0"))}const Ve=({items:e})=>n.jsx(xe,{background:se(),flex:"1",padding:"4",rounded:"md",children:n.jsxs(be,{variant:"striped",colorScheme:"green",children:[e.length===0?n.jsx(ve,{children:"Click 'Change' in the settings panel"}):null,n.jsx(je,{children:n.jsxs(z,{children:[n.jsx(x,{children:"#"}),n.jsx(x,{children:"Date"}),n.jsx(x,{isNumeric:!0,children:"Principal"}),n.jsx(x,{isNumeric:!0,children:"Interest"}),n.jsx(x,{isNumeric:!0,children:"Total"}),n.jsx(x,{isNumeric:!0,children:"Balance"})]})}),n.jsx(we,{children:e.filter(t=>t.isEarly===!0).map((t,a)=>{const s=v(t.interest);return n.jsxs(z,{children:[n.jsx(b,{fontWeight:t.isEarly?"bold":"normal",textColor:t.expected===s?"inherit":"red",children:a+1}),n.jsx(b,{fontWeight:t.isEarly?"bold":"normal",textColor:t.expected===s?"inherit":"red",children:t.date}),n.jsxs(b,{fontWeight:t.isEarly?"bold":"normal",textColor:t.expected===s?"inherit":"red",isNumeric:!0,children:[v(t.principal)," RON"]}),n.jsxs(b,{fontWeight:t.isEarly?"bold":"normal",textColor:t.expected===s?"inherit":"red",isNumeric:!0,children:[v(t.interest)," RON"]}),n.jsxs(b,{fontWeight:t.isEarly?"bold":"normal",textColor:t.expected===s?"inherit":"red",isNumeric:!0,children:[v(t.total)," RON"]}),n.jsxs(b,{fontWeight:t.isEarly?"bold":"normal",textColor:t.expected===s?"inherit":"red",isNumeric:!0,children:[v(t.balance)," RON"]})]},t.id)})})]})}),ze=({children:e})=>n.jsx(q,{bg:T("gray.100","gray.800"),direction:"column",align:"flex-start",minHeight:"100vh",width:"100vw",children:e}),$e=({initialValues:e,onSettingsChange:t})=>{const a=u=>{const d={};return u.balance<=0&&(d.balance="Balance must be greater than 0"),u.interestRate<=0&&(d.interestRate="Interest rate must be greater than 0"),Date.parse(u.firstPayment)>=Date.parse(u.finalMaturity)&&(d.firstPayment="First payment must be before final maturity",d.finalMaturity="Final maturity must be after first payment"),d},{values:s,errors:r,handleChange:i,setFieldValue:c,setFieldTouched:f,handleSubmit:h}=Te({initialValues:e,validateOnMount:!0,validate:a,onSubmit:t}),l=u=>{i(u);const[,,d]=D(u.target.value),p=D(s.finalMaturity);p[2]=d,c("finalMaturity",O(...p)),f("finalMaturity")},y=u=>{i(u);const[,,d]=D(u.target.value),p=D(s.firstPayment);p[2]=d,c("firstPayment",O(...p)),f("finalMaturity")};return n.jsx(R,{background:se(),height:"100%",padding:"4",marginRight:j({base:"0",md:"8"},{fallback:"md"}),marginBlock:j({base:"4",md:"0"},{fallback:"md"}),rounded:j({base:"0",md:"md"},{fallback:"md"}),children:n.jsx("form",{onSubmit:h,children:n.jsxs(Pe,{spacing:"4",align:"flex-start",children:[n.jsxs(M,{isInvalid:!!r.balance,children:[n.jsx(I,{htmlFor:"balance",children:"Balance"}),n.jsxs(F,{children:[n.jsx(E,{pointerEvents:"none",fontSize:"1.2em",children:"$"}),n.jsx(S,{id:"balance",name:"balance",type:"number",variant:"filled",required:!0,value:s.balance,onChange:i})]}),n.jsx(C,{children:r.balance})]}),n.jsxs(M,{isInvalid:!!r.interestRate,children:[n.jsx(I,{htmlFor:"interestRate",children:"Interest Rate"}),n.jsxs(F,{children:[n.jsx(E,{pointerEvents:"none",fontSize:"1.2em",children:"%"}),n.jsx(S,{id:"interestRate",name:"interestRate",type:"number",variant:"filled",required:!0,value:s.interestRate,onChange:i})]}),n.jsx(C,{children:r.interestRate})]}),n.jsxs(M,{isInvalid:!!r.firstPayment,children:[n.jsx(I,{htmlFor:"firstPayment",children:"First Payment"}),n.jsxs(F,{children:[n.jsx(E,{pointerEvents:"none",children:n.jsx($,{})}),n.jsx(S,{id:"firstPayment",name:"firstPayment",type:"date",variant:"filled",required:!0,value:s.firstPayment,onChange:l})]}),n.jsx(C,{children:r.firstPayment})]}),n.jsxs(M,{isInvalid:!!r.finalMaturity,children:[n.jsx(I,{htmlFor:"finalMaturity",children:"Final Maturity"}),n.jsxs(F,{children:[n.jsx(E,{pointerEvents:"none",children:n.jsx($,{})}),n.jsx(S,{id:"finalMaturity",name:"finalMaturity",type:"date",variant:"filled",required:!0,value:s.finalMaturity,onChange:y})]}),n.jsx(C,{children:r.finalMaturity})]}),n.jsx(ne,{type:"submit",colorScheme:"green",width:"full",children:"Change"})]})})})},Ge={data:[]},J=e=>{const{balance:t,finalMaturity:a,firstPayment:s,interestRate:r}=e,i=We(r),c=Oe(s,a),f=[],h=qe(i,c,t);for(let l=1;l<=c;l++){const y=le(s,l),u=Ae(i,t,l,h),d=_e(h,u);f.push({id:ce(),date:y,principal:d,interest:u,total:h,balance:t,expected:u,original:{principal:d,interest:u,total:h,balance:t},isEarly:!1,saved:0})}return f},de=re({name:"items",initialState:Ge,reducers:{addEarlyPayment:(e,t)=>{const{date:a,value:s,type:r,summable:i,expected:c}=t.payload,f=new Date(a),{lastPayment:h,nextPaymentIndex:l,nextWholePayment:y,savedTotal:u}=e.data.reduce((o,g,P)=>(new Date(g.date)<f?(o.savedTotal+=g.saved,o.lastPayment=g,o.lastPaymentIndex=P,g.isEarly||(o.lastWholePayment=g,o.lastWholePaymentIndex=P)):(o.nextPayment=o.nextPayment??g,o.nextPaymentIndex=o.nextPaymentIndex??P,g.isEarly||(o.nextWholePayment=o.nextWholePayment??g,o.nextWholePaymentIndex=o.nextWholePaymentIndex??P)),o),{savedTotal:0}),d=Math.min(h.balance,s+u),p=h.balance-d,B=e.data[e.data.length-1],he=r==="loan"?B.date:le(B.date,-1*Math.floor(d/y.original.principal)),me=H(h.date,a,!0)-1,w=y.original.interest/30*me,A=d+w;let L=[],_=0;if(p>0){L=J({balance:p,firstPayment:y.date,finalMaturity:he,interestRate:5.8});const o=L[0];o.interest=o.original.interest/30*H(a,o.date,!0),o.total=o.original.total-(w-o.interest),o.principal=o.total-o.interest,i&&(_=y.original.total-o.original.total)}const V=[...e.data];V.splice(l),e.data=[...V,{id:ce(),date:a,principal:d,interest:w,total:A,balance:p,original:{principal:d,interest:w,total:A,balance:p},isEarly:!0,saved:_,expected:c},...L]},generateItems:(e,t)=>{e.data=J(t.payload)}}}),{addEarlyPayment:m,generateItems:Ye}=de.actions,He=e=>e.items.data,Ke={balance:588e3,finalMaturity:"2035-12-20",firstPayment:"2021-01-20",interestRate:5.8},ue=re({name:"settings",initialState:Ke,reducers:{setSettings:(e,t)=>{e.balance=t.payload.balance,e.finalMaturity=t.payload.finalMaturity,e.firstPayment=t.payload.firstPayment,e.interestRate=t.payload.interestRate}}}),{setSettings:Je}=ue.actions,Ue=e=>e.settings;globalThis&&globalThis.__generator;globalThis&&globalThis.__spreadArray;var W;(function(e){e.uninitialized="uninitialized",e.pending="pending",e.fulfilled="fulfilled",e.rejected="rejected"})(W||(W={}));var U=k("__rtkq/focused"),X=k("__rtkq/unfocused"),Z=k("__rtkq/online"),Q=k("__rtkq/offline"),N=!1;function Xe(e,t){function a(){var s=function(){return e(U())},r=function(){return e(X())},i=function(){return e(Z())},c=function(){return e(Q())},f=function(){window.document.visibilityState==="visible"?s():r()};N||typeof window<"u"&&window.addEventListener&&(window.addEventListener("visibilitychange",f,!1),window.addEventListener("focus",s,!1),window.addEventListener("online",i,!1),window.addEventListener("offline",c,!1),N=!0);var h=function(){window.removeEventListener("focus",s),window.removeEventListener("visibilitychange",f),window.removeEventListener("online",i),window.removeEventListener("offline",c),N=!1};return h}return t?t(e,{onFocus:U,onFocusLost:X,onOffline:Q,onOnline:Z}):a()}var ee;(function(e){e.query="query",e.mutation="mutation"})(ee||(ee={}));W.uninitialized;var te;typeof queueMicrotask=="function"&&queueMicrotask.bind(typeof window<"u"?window:typeof global<"u"?global:globalThis);const fe=Se({reducer:Ce({items:de.reducer,settings:ue.reducer})});Xe(fe.dispatch);const Ze=()=>{const e=Ne(),t=Y(Ue),a=Y(He),s=r=>{e(Je(r)),e(Ye(r)),e(m({type:"period",value:4330.7,date:"2022-03-03",summable:!1,expected:1169.3})),e(m({type:"period",value:3399.92,date:"2022-04-08",summable:!1,expected:1600.08})),e(m({type:"period",value:3680.18,date:"2022-05-05",summable:!1,expected:1319.82})),e(m({type:"period",value:7913.33,date:"2022-06-21",summable:!1,expected:86.67})),e(m({type:"period",value:7914.97,date:"2022-07-21",summable:!1,expected:85.03})),e(m({type:"period",value:9833.24,date:"2022-08-22",summable:!1,expected:166.76})),e(m({type:"period",value:9918.59,date:"2022-09-21",summable:!1,expected:81.41})),e(m({type:"period",value:15032.58,date:"2022-10-05",summable:!1,expected:1117.42})),e(m({type:"period",value:10011.07,date:"2022-10-27",summable:!1,expected:538.93})),e(m({type:"period",value:12500.49,date:"2022-12-05",summable:!1,expected:1124.51})),e(m({type:"period",value:15000.03,date:"2023-01-03",summable:!1,expected:942.97})),e(m({type:"period",value:15e3,date:"2023-01-31",summable:!1,expected:766.61})),e(m({type:"loan",value:15e3,date:"2023-03-06",summable:!0,expected:1069.38}))};return ae.useEffect(()=>{s(t)},[]),n.jsxs(ze,{children:[n.jsx(Le,{}),n.jsxs(ke,{children:[n.jsx($e,{initialValues:t,onSettingsChange:s}),n.jsx(Ve,{items:a})]})]})},Qe=document.getElementById("root");ie(Qe).render(n.jsx(ae.StrictMode,{children:n.jsx(De,{store:fe,children:n.jsx(Me,{children:n.jsx(Ze,{})})})}));
