import{j as a,I as y,C as Ie,a as Ce,H as Fe,b as Ne,B as re,V as Re,F as ie,c as le,d as De,e as Te,f as Oe,g as se,R as Ee,S as ze,h as Le,u as Ve,i as ke,k as V,G as Be,l as O,m as E,T as _e,n as Ae,o as We,p as qe,q as H,r as p,s as He,t as j,v as Ge}from"./ui-63721c36.js";import{a as $e,R as w,r as Je}from"./react-25ef465b.js";import{u as Ye,a as Ke,c as oe,b as R,d as Ue,e as Xe,P as Ze}from"./state-7f5817c1.js";import{u as ce}from"./forms-1339a094.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var ue,G=$e;ue=G.createRoot,G.hydrateRoot;var de={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},$=w.createContext&&w.createContext(de),b=globalThis&&globalThis.__assign||function(){return b=Object.assign||function(e){for(var n,t=1,l=arguments.length;t<l;t++){n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b.apply(this,arguments)},Qe=globalThis&&globalThis.__rest||function(e,n){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&n.indexOf(l)<0&&(t[l]=e[l]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,l=Object.getOwnPropertySymbols(e);r<l.length;r++)n.indexOf(l[r])<0&&Object.prototype.propertyIsEnumerable.call(e,l[r])&&(t[l[r]]=e[l[r]]);return t};function fe(e){return e&&e.map(function(n,t){return w.createElement(n.tag,b({key:t},n.attr),fe(n.child))})}function S(e){return function(n){return w.createElement(et,b({attr:b({},e.attr)},n),fe(e.child))}}function et(e){var n=function(t){var l=e.attr,r=e.size,i=e.title,o=Qe(e,["attr","size","title"]),c=r||t.size||"1em",u;return t.className&&(u=t.className),e.className&&(u=(u?u+" ":"")+e.className),w.createElement("svg",b({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,l,o,{className:u,style:b(b({color:e.color||t.color},t.style),e.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),i&&w.createElement("title",null,i),e.children)};return $!==void 0?w.createElement($.Consumer,null,function(t){return n(t)}):n(de)}function k(e){return S({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M12 192h424c6.6 0 12 5.4 12 12v260c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V204c0-6.6 5.4-12 12-12zm436-44v-36c0-26.5-21.5-48-48-48h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v36c0 6.6 5.4 12 12 12h424c6.6 0 12-5.4 12-12z"}}]})(e)}function tt(e){return S({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"}}]})(e)}function me(e){return S({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 176c-44.19 0-80-42.99-80-96 0-53.02 35.82-96 80-96s80 42.98 80 96c0 53.03-35.83 96-80 96zm272 48h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"}}]})(e)}function nt(e){return S({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"}}]})(e)}function at(e){return S({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M109.25 173.25c24.99-24.99 24.99-65.52 0-90.51-24.99-24.99-65.52-24.99-90.51 0-24.99 24.99-24.99 65.52 0 90.51 25 25 65.52 25 90.51 0zm256 165.49c-24.99-24.99-65.52-24.99-90.51 0-24.99 24.99-24.99 65.52 0 90.51 24.99 24.99 65.52 24.99 90.51 0 25-24.99 25-65.51 0-90.51zm-1.94-231.43l-22.62-22.62c-12.5-12.5-32.76-12.5-45.25 0L20.69 359.44c-12.5 12.5-12.5 32.76 0 45.25l22.62 22.62c12.5 12.5 32.76 12.5 45.25 0l274.75-274.75c12.5-12.49 12.5-32.75 0-45.25z"}}]})(e)}function rt(e){return S({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"}}]})(e)}var x=(e=>(e[e.Regular=0]="Regular",e[e.ReduceInstallment=1]="ReduceInstallment",e[e.ReducePeriod=2]="ReducePeriod",e))(x||{});function it(e){return Array.from(Array(e))}function J(e){return e<10?`0${e}`:e.toString()}function N(e,n,t){return`${e}-${J(n)}-${J(t)}`}function C(e){const[n,t,l]=e.split("-");return[Number(n),Number(t),Number(l)]}function lt(e,n,t=!0){const l=new Date(e),r=new Date(n);return(r.getFullYear()-l.getFullYear())*12-l.getMonth()+r.getMonth()+Number(t)}function z(e,n,t=!0){const l=new Date(e),r=new Date(n);return Math.floor((r.getTime()-l.getTime())/864e5)+Number(t)}function he(e,n){const t=new Date(e);return t.setMonth(t.getMonth()+n),N(t.getFullYear(),t.getMonth()+1,t.getDate())}function st(){const e=new Date;return N(e.getFullYear(),e.getMonth()+1,e.getDate())}function ot(e){return e/1200}function ge(e,n){return Math.pow(e+1,n)}function ct(e,n,t){const l=ge(e,n);return t*e/(1-1/l)}function ut(e,n,t,l){const r=ge(e,n);return t*r-l*(r-1)/e}function dt(e,n,t,l){return t===1?n*e:ut(e,t-1,n,l)*e}function ft(e,n){return e-n}const Y="abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ0123456789";function ye(e=10){return it(e).map(()=>Y[Math.floor(Math.random()*Y.length)]).join("")}function F(e){return Number(e.toFixed(2).replace(/^-0$/,"0"))}const mt=({onEarlyPaymentAdd:e})=>{const n=o=>e({...o,summable:o.summable==="true",type:Number(o.type)}),{handleChange:t,handleSubmit:l,errors:r,values:i}=ce({initialValues:{type:x.ReduceInstallment.toString(),date:st(),value:1e3,summable:"true"},onSubmit:n,validateOnMount:!0});return a.jsxs(xe,{submitLabel:"Add",title:"Add Early Payment",onSubmit:l,children:[a.jsx(K,{error:r.type,id:"type",options:[{label:"Installment",value:x.ReduceInstallment.toString()},{label:"Period",value:x.ReducePeriod.toString()}],label:"Reduce",value:i.type,onValueChange:t}),a.jsx(P,{error:r.value,icon:a.jsx(y,{as:me}),id:"value",label:"Value",type:"number",value:i.value,onValueChange:t}),a.jsx(P,{error:r.date,icon:a.jsx(y,{as:k}),id:"date",label:"Date",type:"date",value:i.date,onValueChange:t}),a.jsx(K,{error:r.summable,id:"summable",options:[{label:"Yes",value:"true"},{label:"No",value:"false"}],label:"Summable",value:i.summable,onValueChange:t})]})},be=({children:e,title:n})=>a.jsxs(Ie,{children:[a.jsx(Ce,{children:a.jsx(Fe,{size:"md",children:n})}),a.jsx(Ne,{children:e})]}),ht=({label:e})=>a.jsx(re,{type:"submit",colorScheme:"green",width:"full",children:e}),xe=({children:e,onSubmit:n,submitLabel:t,title:l})=>a.jsx(be,{title:l,children:a.jsx("form",{onSubmit:n,children:a.jsxs(Re,{spacing:"4",align:"flex-start",children:[e,a.jsx(ht,{label:t})]})})}),P=({error:e,icon:n,id:t,label:l,onValueChange:r,type:i,value:o})=>a.jsxs(ie,{isInvalid:!!e,children:[a.jsx(le,{htmlFor:t,children:l}),a.jsxs(De,{children:[a.jsx(Te,{pointerEvents:"none",fontSize:"1.2em",children:n}),a.jsx(Oe,{id:t,name:t,type:i,variant:"filled",required:!0,value:o,onChange:r})]}),a.jsx(se,{children:e})]}),K=({error:e,id:n,label:t,onValueChange:l,options:r,value:i})=>a.jsxs(ie,{isInvalid:!!e,children:[a.jsx(le,{htmlFor:n,children:t}),a.jsx(Ee,{id:n,name:n,value:i,children:a.jsx(ze,{direction:"row",children:r.map(({label:o,value:c})=>a.jsx(Le,{value:c,onChange:l,children:o},c))})}),a.jsx(se,{children:e})]}),gt=()=>{const{colorMode:e,toggleColorMode:n}=Ve();return a.jsxs(a.Fragment,{children:[a.jsx(ke,{textColor:V("whiteAlpha.900","whiteAlpha.900"),fontWeight:"bold",children:"1Percent"}),a.jsx(re,{onClick:n,"aria-label":"Change theme",children:e==="light"?a.jsx(y,{as:nt}):a.jsx(y,{as:rt})})]})},yt=({header:e,main:n,sidebar:t})=>a.jsxs(Be,{background:V("gray.100","gray.800"),gap:"4",gridTemplateColumns:O({base:"100%",md:"0 300px 1fr 0"},{fallback:"md"}),gridTemplateRows:O({base:"64px auto auto",md:"64px 1fr 0"},{fallback:"md"}),minHeight:"100vh",templateAreas:O({base:'"header" "sidebar" "main"',md:'"header header header header" "buffer1 sidebar main buffer2" "footer footer footer footer"'},{fallback:"md"}),children:[a.jsx(E,{alignItems:"center",area:"header",background:V("green.600","gray.900"),display:"flex",justifyContent:"space-between",paddingInline:"4",children:e}),a.jsx(E,{area:"sidebar",display:"grid",gap:"4",height:"fit-content",children:t}),a.jsx(E,{area:"main",overflow:"auto",children:n})]}),bt=({items:e})=>a.jsx(be,{title:"Repayment Schedule",children:a.jsx(_e,{children:a.jsxs(Ae,{variant:"striped",colorScheme:"green",children:[e.length===0?a.jsx(We,{children:"Click 'Change' in the settings panel"}):null,a.jsx(qe,{children:a.jsxs(H,{children:[a.jsx(p,{children:"#"}),a.jsx(p,{children:"Early"}),a.jsx(p,{children:"Date"}),a.jsx(p,{isNumeric:!0,children:"Principal"}),a.jsx(p,{isNumeric:!0,children:"Interest"}),a.jsx(p,{isNumeric:!0,children:"Total"}),a.jsx(p,{isNumeric:!0,children:"Balance"})]})}),a.jsx(He,{children:e.map((n,t)=>a.jsxs(H,{children:[a.jsx(j,{children:t+1}),a.jsx(j,{children:n.repaymentType!==x.Regular?a.jsx(y,{as:tt}):null}),a.jsx(j,{children:n.date}),a.jsxs(j,{isNumeric:!0,children:[F(n.principal)," RON"]}),a.jsxs(j,{isNumeric:!0,children:[F(n.interest)," RON"]}),a.jsxs(j,{isNumeric:!0,children:[F(n.total)," RON"]}),a.jsxs(j,{isNumeric:!0,children:[F(n.balance)," RON"]})]},n.id))})]})})}),xt=({initialValues:e,onSettingsChange:n})=>{const t=m=>{const f={};return m.balance<=0&&(f.balance="Balance must be greater than 0"),m.interestRate<=0&&(f.interestRate="Interest rate must be greater than 0"),Date.parse(m.firstPayment)>=Date.parse(m.finalMaturity)&&(f.firstPayment="First payment must be before final maturity",f.finalMaturity="Final maturity must be after first payment"),f},{errors:l,handleChange:r,handleSubmit:i,setFieldTouched:o,setFieldValue:c,values:u}=ce({initialValues:e,onSubmit:n,validate:t,validateOnMount:!0}),s=m=>{r(m);const[,,f]=C(m.target.value),h=C(u.finalMaturity);h[2]=f,c("finalMaturity",N(...h)),o("finalMaturity")},g=m=>{r(m);const[,,f]=C(m.target.value),h=C(u.firstPayment);h[2]=f,c("firstPayment",N(...h)),o("finalMaturity")};return a.jsxs(xe,{submitLabel:"Change",title:"Settings",onSubmit:i,children:[a.jsx(P,{error:l.balance,icon:a.jsx(y,{as:me}),id:"balance",onValueChange:r,label:"Balance",type:"number",value:u.balance}),a.jsx(P,{error:l.interestRate,icon:a.jsx(y,{as:at}),id:"interestRate",onValueChange:r,label:"Interest Rate",type:"number",value:u.interestRate}),a.jsx(P,{error:l.firstPayment,icon:a.jsx(y,{as:k}),id:"firstPayment",onValueChange:s,label:"First Payment",type:"date",value:u.firstPayment}),a.jsx(P,{error:l.finalMaturity,icon:a.jsx(y,{as:k}),id:"finalMaturity",onValueChange:g,label:"Final Maturity",type:"date",value:u.finalMaturity})]})},vt=Ye,U=Ke,pt=localStorage.getItem("items")?JSON.parse(localStorage.getItem("items")):{data:[]},X=e=>{var s;const{balance:n,finalMaturity:t,firstPayment:l,interestRate:r}=e,i=ot(r),o=lt(l,t),c=[],u=ct(i,o,n);for(let g=0;g<o;g++){const m=he(l,g),f=dt(i,n,g+1,u),h=ft(u,f),M=(((s=c[g-1])==null?void 0:s.balance)??n)-h;c.push({id:ye(),repaymentType:x.Regular,date:m,principal:h,interest:f,total:u,balance:M,original:{principal:h,interest:f,total:u,balance:M},saved:0})}return c},ve=oe({name:"items",initialState:pt,reducers:{addEarlyPayment:(e,n)=>{const{date:t,value:l,type:r,summable:i}=n.payload,o=new Date(t),{lastPayment:c,lastWholePayment:u,nextWholePayment:s,nextWholePaymentIndex:g,savedTotal:m}=e.data.reduce((d,v,I)=>{const Me=new Date(v.date)<o,q=v.repaymentType===x.Regular;return Me?(d.savedTotal+=v.saved,d.lastPayment=v,d.lastPaymentIndex=I,q&&(d.lastWholePayment=v,d.lastWholePaymentIndex=I)):(d.nextPayment=d.nextPayment??v,d.nextPaymentIndex=d.nextPaymentIndex??I,q&&(d.nextWholePayment=d.nextWholePayment??v,d.nextWholePaymentIndex=d.nextWholePaymentIndex??I)),d},{savedTotal:0}),f=Math.min(c.balance,l+m),h=c.balance-f,M=e.data[e.data.length-1],we=r===x.ReduceInstallment?M.date:he(M.date,-1*Math.floor(f/s.original.principal)),Pe=z(u.date,s.date,!0),Se=z(c.date,t,!0),D=s.original.interest/30*(Se-(Pe-30)),_=f+D;let T=[],A=0;if(h>0){T=X({balance:h,firstPayment:s.date,finalMaturity:we,interestRate:5.8});const d=T[0];d.interest=d.original.interest/30*z(t,d.date,!0),d.total=d.original.total-(d.original.interest-d.interest),i&&(A=s.original.total-d.original.total)}const W=[...e.data];W.splice(g),e.data=[...W,{id:ye(),repaymentType:r,date:t,principal:f,interest:D,total:_,balance:h,original:{principal:f,interest:D,total:_,balance:h},saved:A},...T],localStorage.setItem("items",JSON.stringify(e))},generateItems:(e,n)=>{e.data=X(n.payload),localStorage.setItem("items",JSON.stringify(e))}}}),{addEarlyPayment:jt,generateItems:wt}=ve.actions,Pt=e=>e.items.data,St=localStorage.getItem("settings")?JSON.parse(localStorage.getItem("settings")):{balance:588e3,finalMaturity:"2035-12-20",firstPayment:"2021-01-20",interestRate:5.8},pe=oe({name:"settings",initialState:St,reducers:{setSettings:(e,n)=>{e.balance=n.payload.balance,e.finalMaturity=n.payload.finalMaturity,e.firstPayment=n.payload.firstPayment,e.interestRate=n.payload.interestRate,localStorage.setItem("settings",JSON.stringify(e))}}}),{setSettings:Mt}=pe.actions,It=e=>e.settings;globalThis&&globalThis.__generator;globalThis&&globalThis.__spreadArray;var B;(function(e){e.uninitialized="uninitialized",e.pending="pending",e.fulfilled="fulfilled",e.rejected="rejected"})(B||(B={}));var Z=R("__rtkq/focused"),Q=R("__rtkq/unfocused"),ee=R("__rtkq/online"),te=R("__rtkq/offline"),L=!1;function Ct(e,n){function t(){var l=function(){return e(Z())},r=function(){return e(Q())},i=function(){return e(ee())},o=function(){return e(te())},c=function(){window.document.visibilityState==="visible"?l():r()};L||typeof window<"u"&&window.addEventListener&&(window.addEventListener("visibilitychange",c,!1),window.addEventListener("focus",l,!1),window.addEventListener("online",i,!1),window.addEventListener("offline",o,!1),L=!0);var u=function(){window.removeEventListener("focus",l),window.removeEventListener("visibilitychange",c),window.removeEventListener("online",i),window.removeEventListener("offline",o),L=!1};return u}return n?n(e,{onFocus:Z,onFocusLost:Q,onOffline:te,onOnline:ee}):t()}var ne;(function(e){e.query="query",e.mutation="mutation"})(ne||(ne={}));B.uninitialized;var ae;typeof queueMicrotask=="function"&&queueMicrotask.bind(typeof window<"u"?window:typeof global<"u"?global:globalThis);const je=Ue({reducer:Xe({items:ve.reducer,settings:pe.reducer})});Ct(je.dispatch);const Ft=()=>{const e=vt(),n=U(It),t=U(Pt),l=i=>{e(jt(i))},r=i=>{e(Mt(i)),e(wt(i))};return a.jsx(yt,{header:a.jsx(gt,{}),main:a.jsx(bt,{items:t}),sidebar:a.jsxs(a.Fragment,{children:[a.jsx(xt,{initialValues:n,onSettingsChange:r}),t.length>0?a.jsx(mt,{onEarlyPaymentAdd:l}):null]})})},Nt=document.getElementById("root");ue(Nt).render(a.jsx(Je.StrictMode,{children:a.jsx(Ze,{store:je,children:a.jsx(Ge,{children:a.jsx(Ft,{})})})}));
